# 12月7日　作業内容

## ログ保存の機能の追加


### 現状の確認
ログ保存の流れ：
- ユーザーが企画を入力し、「レビュー開始」 → create_session_logで「修正前」の企画案(new_ideas)が保存される。
- ユーザーが問いに回答・フィードバック → append_feedbackで評価が保存される。

欠けている点：
- ユーザーが問いを受けて「書き直した後の企画案」を保存する機能がない
- そのため、ログファイルには「最初の思い付き」しか残らず、「問いによってどう改善されたか」を比較・分析できない。

### 目指す姿
ログ保存の流れ：
- レビュー開始 → 「修正前」を保存(既存通り)
- 「追加」修正完了後、「保存ボタン」を押す → 「修正後」の企画案を同じログファイルに追記する
データ構造の変化：
- ログファイルにリストで追加していくような形に変更する

思考の過程を一回ごとに保存していく
最初の案と最終の案だけを保存するのではなく
更新ボタンが押されたごとに履歴を追加していく

### ログ保存に関するファイルの理解

以下のファイルにログ保存に関する機能が定義されている
backend/app/services/logging_service.py

#### get_log_root_dir関数
目的：ログのルートディレクトリを返す

return Path(__file__).resolve().parent.parent / "logs"

__file__：この関数が書かれているPythonファイル自体のパス
    　今回の場合は「backend/app/services/logging_service.py」

Path(__file__)：文字列のパスをPathオブジェクトに変換

.resolve：シンボリックリンクを解決し、絶対パスに変換、これを行うことで、論理的に同一なのに別物として扱われてしまうパスをつぶすことができる。

parent.parent：今いるディレクトリから二段上へ移動する

/ "logs"：pathlibでは、/はパス結合演算子、OSに依存しない

この関数でしたいこと：
常に backend/app/logs
の絶対パスを返す

なぜこのようなことをするのか：
このログがどこで実行されていても、同一の場所に集まらなければ、実験も運用も成立しないから

### 行ったこと
1. ログ管理方法の追加：ファイル → backend/app/services/logging_service.py
2. APIエンドポイントの作成：ファイル → backend/app/main.py
3. 保存ボタンの追加：ファイル → backend/templates/index.html
4. フロントエンドの処理実装：ファイル → backend/statics/js/app.js

### エラー
ボタンを押してもうまくログを保存できなかった
理由：変数の宣言忘れ、IDの保存忘れ
対象ファイル：backend/statics/js/app.js